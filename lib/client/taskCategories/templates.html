<template name="taskCategoriesList">
    <ul>
        {{#if taskCategories}}
            {{#each taskCategories}}
                <li>{{> taskCategory}}</li>
            {{/each}}
        {{/if}}
    </ul>
</template>

<template name="taskCategory">
    {{#if selectedTaskCategory}}
        {{> editTaskCategoryForm doc=this }}
    {{else}}
        <h4>{{title}}</h4>

        {{# if addTaskSubCategory}}
            {{> insertTaskCategoryForm doc=doc docType=docType parent=_id buttonText=buttonTextSubCategory}}
        {{else}}
            <button class="addTaskSubCategory">Add SubCategory</button>
        {{/if}}

        <button class="editTaskCategory">Edit Category</button>
        <button class="deleteTaskCategory">Delete Category</button>
    {{/if}}
    <hr />
    <p>{{> insertTaskForm doc=doc docType=docType category=_id}} </p>

    {{#if taskSubCategories}}
        <ul>
            {{#each taskSubCategories}}
                <li>{{> taskCategory}}</li>
            {{/each}}
        </ul>
    {{/if}}
    {{> tasksList doc=doc docType=docType category=_id}}
</template>

<template name="insertTaskCategoryForm">
    {{#autoForm collection="TaskCategories" meteormethod="newTaskCategory" type="insert" id="insertTaskCategoryForm"}}
        {{> afQuickField name='title'}}
        {{> afQuickField name='doc' value=doc type='hidden'}}
        {{> afQuickField name='docType' value=docType type='hidden'}}
        {{> afQuickField name='parent' value=parent type='hidden'}}
        <button id="submitTaskCategoryForm" type="submit">{{buttonText}}</button>
        <button id="cancelTaskCategoryForm">Cancel</button>
    {{/autoForm}}
</template>

<template name="editTaskCategoryForm">
    {{#autoForm collection="TaskCategories" doc=doc meteormethod="updateTaskCategory" type="update" id="editTaskCategoryForm"}}
        {{> afQuickField name='title'}}
        <button id="submitUpdate" type="submit">Update</button>
        <button id="cancelUpdate" type="submit">Cancel</button>
    {{/autoForm}}
</template>
